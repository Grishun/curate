services:
  curate:
    build: .
    ports:
      - "8080:8080"
      - "8081:8081"
    environment:
      CURATE_POLLING_INTERVAL: 10s
      CURATE_CURRENCIES: BTC,ETH,TRX,SOL
      CURATE_REST_HOST: 0.0.0.0
      CURATE_REST_PORT: 8080
      CURATE_GRPC_HOST: 0.0.0.0
      CURATE_GRPC_PORT: 8081
      CURATE_QUOTE: USD
      CURATE_HISTORY_LIMIT: 100
      CURATE_COINDESK_URI: https://min-api.cryptocompare.com
      CURATE_COINDESK_TOKEN:
      CURATE_INFLUXDB_URI: http://influxdb3-dev:8181
      CURATE_INFLUXDB_TOKEN: dev-token
      CURATE_INFLUXDB_BUCKET: curate

  influxdb3-core:
    container_name: influxdb3-dev
    image: influxdb:3-core
    ports:
      - "8181:8181"
    command: >
      influxdb3 serve
      --node-id=node0 
      --object-store=file
      --without-auth
      --data-dir=/var/lib/influxdb3
      --plugin-dir=/plugins
    volumes:
      - influxdb3_data:/var/lib/influxdb3
      - influxdb3_plugins:/plugins
    environment:
      INFLUXDB3_NODE_IDENTIFIER: 00
      INFLUXDB3_OBJECT_STORE: file

volumes:
  influxdb3_data:
  influxdb3_plugins:
